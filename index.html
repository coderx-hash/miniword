<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Offline Word Style Editor</title>

<style>
body{
 margin:0;
 font-family:system-ui,Arial;
 background:#f3f4f6;
}

.toolbar{
 position:sticky;
 top:0;
 background:#fff;
 padding:10px;
 display:flex;
 flex-wrap:wrap;
 gap:6px;
 box-shadow:0 2px 10px rgba(0,0,0,.1);
}

button,input[type=color]{
 border:0;
 padding:7px 10px;
 border-radius:8px;
 background:#eef2ff;
 cursor:pointer;
}

.wrapper{
 display:flex;
 justify-content:center;
 padding:15px;
}

.page{
 background:#fff;
 width:794px;
 min-height:1123px;
 padding:40px;
 outline:none;
 box-shadow:0 10px 25px rgba(0,0,0,.15);
}

.landscape{
 width:1123px;
 min-height:794px;
}

table{
 border-collapse:collapse;
 width:100%;
}
td,th{
 border:1px solid #000;
 padding:6px;
}

@media(max-width:900px){
 .page{
   width:100%;
   min-height:90vh;
   padding:20px;
   box-shadow:none;
 }
}

@media print{
 .toolbar{display:none;}
 .page{
   width:210mm;
   min-height:297mm;
   padding:20mm;
   box-shadow:none;
 }
 .landscape{
   width:297mm;
   min-height:210mm;
 }
}
</style>
</head>

<body>

<div class="toolbar">

<button onclick="cmd('bold')">B</button>
<button onclick="cmd('italic')">I</button>
<button onclick="cmd('underline')">U</button>

<input type="color" onchange="cmd('foreColor',this.value)">
<input type="color" onchange="cmd('hiliteColor',this.value)">

<button onclick="insertTable()">Table</button>
<button onclick="toggleOrientation()">Portrait/Landscape</button>

<button onclick="saveFile()">ðŸ’¾ Save File</button>

<label style="background:#eef2ff;padding:7px 10px;border-radius:8px;cursor:pointer;">
ðŸ“‚ Open
<input type="file" id="openFile" hidden>
</label>

<button onclick="window.print()">Print</button>

</div>

<div class="wrapper">
<div id="editor" class="page" contenteditable="true">
<h2>Offline Word Editor</h2>
<p>CTRL+S saves real file. SHIFT+F3 works.</p>
</div>
</div>

<script>

const editor=document.getElementById("editor");

/* BASIC COMMAND */
function cmd(c,v=null){
 document.execCommand(c,false,v);
}

/* TABLE */
function insertTable(){
 let r=prompt("Rows?");
 let c=prompt("Columns?");
 if(!r||!c)return;

 let html="<table>";
 for(let i=0;i<r;i++){
  html+="<tr>";
  for(let j=0;j<c;j++){
    html+="<td>Text</td>";
  }
  html+="</tr>";
 }
 html+="</table>";

 document.execCommand("insertHTML",false,html);
}

/* ORIENTATION */
function toggleOrientation(){
 editor.classList.toggle("landscape");
}

/* ===== REAL FILE SAVE (OFFLINE LIKE WORD) ===== */
function saveFile(){

 const fullHTML=`
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Saved Document</title>
</head>
<body>
${editor.outerHTML}
</body>
</html>`;

 const blob=new Blob([fullHTML],{type:"text/html"});
 const a=document.createElement("a");
 a.href=URL.createObjectURL(blob);
 a.download="MyDocument.html";
 a.click();
}

/* ===== OPEN SAVED FILE ===== */
document.getElementById("openFile").addEventListener("change",function(e){

 const file=e.target.files[0];
 if(!file) return;

 const reader=new FileReader();

 reader.onload=function(event){

   const parser=new DOMParser();
   const doc=parser.parseFromString(event.target.result,"text/html");
   const loaded=doc.querySelector(".page");

   if(loaded){
     editor.innerHTML=loaded.innerHTML;
   }

 };

 reader.readAsText(file);
});

/* ===== PASTE IMAGE ===== */
editor.addEventListener("paste",function(e){
 const items=(e.clipboardData||window.clipboardData).items;

 for(let i=0;i<items.length;i++){
  if(items[i].type.indexOf("image")!==-1){
    e.preventDefault();
    const blob=items[i].getAsFile();
    const reader=new FileReader();
    reader.onload=function(event){
      document.execCommand("insertImage",false,event.target.result);
    };
    reader.readAsDataURL(blob);
  }
 }
});

/* ===== KEYBOARD SHORTCUTS ===== */
document.addEventListener("keydown",function(e){

 if(e.ctrlKey){

  if(e.key==="b"){e.preventDefault();cmd("bold");}
  if(e.key==="i"){e.preventDefault();cmd("italic");}
  if(e.key==="u"){e.preventDefault();cmd("underline");}
  if(e.key==="p"){e.preventDefault();window.print();}

  /* CTRL+S REAL SAVE */
  if(e.key==="s"){
   e.preventDefault();
   saveFile();
  }
 }

 /* SHIFT+F3 CASE CHANGE */
 if(e.shiftKey && e.key==="F3"){
  e.preventDefault();
  toggleCase();
 }

});

function toggleCase(){

 let sel=window.getSelection();
 if(!sel.rangeCount)return;

 let range=sel.getRangeAt(0);
 let text=range.toString();
 if(!text)return;

 let newText;

 if(text===text.toUpperCase()){
   newText=text.toLowerCase();
 }else if(text===text.toLowerCase()){
   newText=text.replace(/\b\w/g,l=>l.toUpperCase());
 }else{
   newText=text.toUpperCase();
 }

 document.execCommand("insertText",false,newText);
}

</script>

</body>
</html>
