<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Modern Word Whiteboard PRO</title>

<style>

:root{
  --bg:#f3f4f6;
  --card:#ffffff;
}

body{
  margin:0;
  font-family:system-ui,Segoe UI,Arial;
  background:var(--bg);
}

/* ===== TOOLBAR ===== */
.toolbar{
  position:sticky;
  top:0;
  background:#fff;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  padding:10px;
  box-shadow:0 2px 10px rgba(0,0,0,.08);
  z-index:999;
}

button,select,input[type=color]{
  border:0;
  padding:7px 10px;
  border-radius:8px;
  background:#eef2ff;
  cursor:pointer;
}

.wrapper{
  display:flex;
  justify-content:center;
  padding:15px;
}

.page{
  background:white;
  width:794px;
  min-height:1123px;
  padding:40px;
  box-shadow:0 10px 25px rgba(0,0,0,.15);
  outline:none;
  transition:.2s;
}

.landscape{
  width:1123px;
  min-height:794px;
}

table{
  width:100%;
  border-collapse:collapse;
}
td,th{
  border:1px solid #000;
  padding:6px;
}

/* MOBILE */
@media(max-width:900px){
  .page{
    width:100%;
    min-height:90vh;
    padding:20px;
    box-shadow:none;
  }
}

/* PRINT A4 */
@media print{
.toolbar{display:none;}
.page{
  width:210mm;
  min-height:297mm;
  padding:20mm;
  box-shadow:none;
}
.landscape{
  width:297mm;
  min-height:210mm;
}
}

</style>
</head>
<body>

<div class="toolbar">

<button onclick="cmd('bold')">B</button>
<button onclick="cmd('italic')">I</button>
<button onclick="cmd('underline')">U</button>

<select onchange="fontSize(this.value)">
<option value="">Font Size</option>
<option value="1">10</option>
<option value="3">14</option>
<option value="5">18</option>
<option value="7">24</option>
</select>

<input type="color" onchange="cmd('foreColor',this.value)">
<input type="color" onchange="cmd('hiliteColor',this.value)">

<button onclick="insertTable()">Table</button>
<button onclick="toggleOrientation()">Portrait / Landscape</button>
<button onclick="saveData()">Save</button>
<button onclick="window.print()">Print</button>

</div>

<div class="wrapper">
<div id="editor" class="page" contenteditable="true">
<h2>Modern Editor PRO</h2>
<p>Keyboard shortcuts like Word are enabled.</p>
</div>
</div>

<script>

const editor=document.getElementById("editor");

/* BASIC COMMAND */
function cmd(c,v=null){
 document.execCommand(c,false,v);
}

/* FONT SIZE */
function fontSize(size){
 document.execCommand("fontSize",false,size);
}

/* TABLE */
function insertTable(){
 let r=prompt("Rows?");
 let c=prompt("Columns?");
 if(!r||!c)return;

 let html="<table>";
 for(let i=0;i<r;i++){
  html+="<tr>";
  for(let j=0;j<c;j++){
    html+="<td>Text</td>";
  }
  html+="</tr>";
 }
 html+="</table>";

 document.execCommand("insertHTML",false,html);
}

/* ORIENTATION */
function toggleOrientation(){
 editor.classList.toggle("landscape");
 saveData();
}

/* SAVE */
function saveData(){
 localStorage.setItem("modernEditor",editor.innerHTML);
 localStorage.setItem("orientation",editor.classList.contains("landscape"));
}

/* LOAD */
function loadData(){
 const data=localStorage.getItem("modernEditor");
 const orient=localStorage.getItem("orientation");

 if(data) editor.innerHTML=data;
 if(orient==="true") editor.classList.add("landscape");
}

window.onload=loadData;

/* AUTO SAVE */
editor.addEventListener("input",saveData);

/* ===== PASTE IMAGE ===== */
editor.addEventListener("paste",function(e){
 const items=(e.clipboardData||window.clipboardData).items;
 for(let i=0;i<items.length;i++){
  if(items[i].type.indexOf("image")!==-1){
    e.preventDefault();
    const blob=items[i].getAsFile();
    const reader=new FileReader();
    reader.onload=function(event){
      document.execCommand("insertImage",false,event.target.result);
    };
    reader.readAsDataURL(blob);
  }
 }
});

/* ===== KEYBOARD SHORTCUTS LIKE WORD ===== */

document.addEventListener("keydown",function(e){

/* CTRL SHORTCUTS */
if(e.ctrlKey){

 if(e.key==="b"){ e.preventDefault(); cmd("bold"); }
 if(e.key==="i"){ e.preventDefault(); cmd("italic"); }
 if(e.key==="u"){ e.preventDefault(); cmd("underline"); }

 if(e.key==="s"){ e.preventDefault(); saveData(); alert("Saved!"); }
 if(e.key==="p"){ e.preventDefault(); window.print(); }

 if(e.key==="l"){ e.preventDefault(); cmd("justifyLeft"); }
 if(e.key==="e"){ e.preventDefault(); cmd("justifyCenter"); }
 if(e.key==="r"){ e.preventDefault(); cmd("justifyRight"); }
 if(e.key==="j"){ e.preventDefault(); cmd("justifyFull"); }

}

/* CTRL + SHIFT FONT SIZE */
if(e.ctrlKey && e.shiftKey){
 if(e.key===">"){ e.preventDefault(); cmd("increaseFontSize"); }
 if(e.key==="<"){ e.preventDefault(); cmd("decreaseFontSize"); }
}

/* ===== SHIFT + F3 TOGGLE CASE ===== */
if(e.shiftKey && e.key==="F3"){
 e.preventDefault();
 toggleCase();
}

});

/* SHIFT+F3 FUNCTION */
function toggleCase(){

 let sel=window.getSelection();
 if(!sel.rangeCount) return;

 let range=sel.getRangeAt(0);
 let text=range.toString();
 if(!text) return;

 let newText;

 if(text===text.toUpperCase()){
   newText=text.toLowerCase();
}else if(text===text.toLowerCase()){
   newText=text.replace(/\b\w/g,l=>l.toUpperCase());
}else{
   newText=text.toUpperCase();
}

document.execCommand("insertText",false,newText);
}

</script>

</body>
</html>
